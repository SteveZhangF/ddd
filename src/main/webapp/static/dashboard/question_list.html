<!--
  ~ Copyright (c) 2015. Lorem ipsum dolor sit amet, consectetur adipiscing elit.
  ~ Morbi non lorem porttitor neque feugiat blandit. Ut vitae ipsum eget quam lacinia accumsan.
  ~ Etiam sed turpis ac ipsum condimentum fringilla. Maecenas magna.
  ~ Proin dapibus sapien vel ante. Aliquam erat volutpat. Pellentesque sagittis ligula eget metus.
  ~ Vestibulum commodo. Ut rhoncus gravida arcu.
  -->

<div ng-controller="QuestionController as controller" class="row">
    <div class="">

        <table st-table="questions" class="table table-striped">
            <thead>
            <tr>
                <th st-sort="{{$index}}">Index</th>
                <th st-sort="id">ID</th>
                <th st-sort="name">Name</th>
                <th st-sort="type">Type</th>
                <th>
                    <button type="button" ng-click="createNew()" class="btn btn-md btn-success">
                        <i class="glyphicon glyphicon-plus">
                        </i>
                    </button>
                </th>
            </tr>
            <tr>
                <th colspan="2">
                    <input st-search="name" placeholder="search for name" class="input-sm form-control"
                           type="search"/>
                </th>
                <th colspan="2">
                    <input st-search="type" placeholder="search for type" class="input-sm form-control"
                           type="search"/>
                </th>
            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="x in questions">
                <td>{{ $index + 1 }}</td>
                <td>{{ x.id }}</td>
                <td>{{x.name}}</td>
                <td>{{x.type}}</td>
                <td>
                    <button type="button" ng-click="editor(x)" class="btn btn-md btn-success">
                        <i class="glyphicon glyphicon-edit">
                        </i>
                    </button>
                    <button type="button" ng-click="delete(x)" class="btn btn-md btn-danger">
                        <i class="glyphicon glyphicon-remove"></i>
                    </button>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>
<script type="text/ng-template" id="question-editor.html">
    <h1>Editing Question</h1>
    <div class="well">
        <form class="form-horizontal">
            <div class="form-group">
                <div class="col-md-4">
                    <label for="name">Question Name:</label>
                </div>
                <div class="col-md-8">
                    <input ng-model="question.name" type="text" class="form-control" id="name"
                           placeholder="please input the question name">
                </div>
            </div>
            <div class="form-group">
                <div class="col-md-4">
                    <label for="type">Type:</label>
                </div>
                <div class="col-md-8">
                    <select class="form-control" id='type' ng-options=" type for  type in types "
                            ng-change="typeChanged()"
                            ng-model="question.type"></select>
                </div>
            </div>
            <div class='form-group' ng-if="question.type=='select'||question.type=='checkbox'">
                {{question}}
                <div class="col-md-4">
                    <label >options</label>
                </div>
                <div class="col-md-8">

                    <div class="row">
                        <div class="col-md-4">Name</div>
                        <div class="col-md-4">Value</div>
                        <div class="col-md-4"></div>
                    </div>

                    <div ng-repeat="op in question.options" class="row">
                        <div class="col-md-4"><input type="text" class="form-control" ng-model="op.name"></div>
                        <div class="col-md-4"><input type="text" class="form-control" ng-model="op.value"></div>
                        <div class="col-md-4"><button ng-click="removeOption($index)" type="button" class="btn btn-danger">Delete</button></div>
                    </div>
                    <div class="row">
                        <div class="col-md-4"><input type="text" class="form-control" ng-model="newOp.name"></div>
                        <div class="col-md-4"><input type="text" class="form-control" ng-model="newOp.value"></div>
                        <div class="col-md-4"><button class="btn btn-md-primary" ng-click="addOption()">Add</button></div>
                    </div>
                    <hr>
                </div>

            </div>
            <div class="form-group">
                <div class="col-md-4">
                    <label for="description" ng-model="questions.options">Description</label>
                </div>
                <div class="col-md-8">
                    <textarea ng-model="question.description" class='form-control' id='description'></textarea>
                </div>
            </div>
            <input ng-model="question.id" type="hidden"/>
        </form>
        <hr>
        Preview:
        <preview-question data-question="question"></preview-question>

        <div class="row">
            <button type="button" class="ngdialog-button ngdialog-button-primary" ng-click="ok()">OK</button>
            <button type="button" class="ngdialog-button ngdialog-button-secondary" ng-click="cancel()">Cancel</button>
        </div>
    </div>
</script>
<script type="text/ng-template" id="question-delete.html">
    <p>Are you sure you want to delete the questions?</p>
    <div class="ngdialog-buttons">
        <button type="button" class="ngdialog-button ngdialog-button-secondary" ng-click="cancel()">No
        </button>
        <button type="button" class="ngdialog-button ngdialog-button-primary" ng-click="deleteOk()">Yes</button>
    </div>
</script>
<style>
    .st-sort-ascent:before {
        content: '\25B2';
    }

    .st-sort-descent:before {
        content: '\25BC';
    }

</style>